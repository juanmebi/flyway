pipeline {
  agent any 
  environment {
    DB_PROTEOMES=credentials('db-proteomes')
  }
  stages {
    stage('Build - DB Migration') {
              environment {
                  FLYWAY_LOCATIONS='filesystem:/${WORKSPACE}/sql'
                  FLYWAY_URL='jdbc:postgresql://localhost:5432/postgres'
                  FLYWAY_USER='postgres'
                  FLYWAY_PASSWORD='test'
                  FLYWAY_SCHEMAS='public'
                  FLYWAY_PATH='/usr/local/bin/flyway-9.0.1'
              }
              steps {
                  sh 'Flyway path'
                  echo "$FLYWAY_PATH"
                  echo 'Password-------'
                  echo "$DB_PROTEOMES_PSW"
                  
                  echo 'Locations Path'
                  echo "$FLYWAY_LOCATIONS"
                 
                  sh 'flyway info'
                  sh '$FLYWAY_PATH/flyway -user=$FLYWAY_USER -password=$FLYWAY_PASSWORD -url=$FLYWAY_URL -locations=$FLYWAY_LOCATIONS info'
              }
    }
  }
}
